function getFrequency(e,t=!0){const s={};for(let r=0;r<e.length;r++){const a=e[r].word.at(t?0:-1);s[a]=(s[a]||0)+1}return s}importScripts("https://cdn.jsdelivr.net/npm/fflate@0.8.0/umd/index.js","https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"),self.onmessage=function(e){"start"===e.data.type&&fetch("https://xcrypt0r.github.io/db/db.csv.gz").then((e=>e.arrayBuffer())).then((e=>{const t=fflate.decompressSync(new Uint8Array(e)),s=new TextDecoder("utf-8").decode(t),r=[];Papa.parse(s,{skipEmptyLines:!0,step:function(e){const t=e.data;if("O"!==t[5])return;const s=t[0];r.push({word:s,species:t[1].split("|"),parts:t[2].split("|"),categories:t[3].split("|"),topics:t[4].split("|"),firstCharacter:s[0],lastCharacter:s[s.length-1],firstCharacterPhonemes:t[6],allPhonemes:t[7],lastCharacterPhonemes:t[8]})},complete:function(){self.postMessage({type:"db",db:r,firstCharacterfrequency:getFrequency(r,!0),lastCharacterfrequency:getFrequency(r,!1)})}})})).catch((e=>{self.postMessage({type:"error",message:e.message})}))};
