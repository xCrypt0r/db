const decoder=new TextDecoder("utf-8");function getFrequency(e,t=!0){let r={};for(let a=0;a<e.length;a++){let s=e[a].word.at(t?0:-1);r[s]=(r[s]||0)+1}return r}self.onmessage=async e=>{if("load"===e.data.type)try{let t=await fetch(e.data.url).then((e=>e.arrayBuffer())),r=fflate.decompressSync(new Uint8Array(t)),a=decoder.decode(r),s=[];Papa.parse(a,{skipEmptyLines:!0,step:({data:e})=>{if("O"!==e[5])return;let t=e[0];s.push({word:t,species:e[1].split("|"),parts:e[2].split("|"),categories:e[3].split("|"),topics:e[4].split("|"),firstCharacter:t[0],lastCharacter:t[t.length-1],firstCharacterPhonemes:e[6],allPhonemes:e[7],lastCharacterPhonemes:e[8]})},complete:()=>{self.postMessage({type:"db",db:s,firstCharacterfrequency:getFrequency(s,!0),lastCharacterfrequency:getFrequency(s,!1)})}})}catch(e){self.postMessage({type:"error",message:e.message})}};
