importScripts("https://cdn.jsdelivr.net/npm/fflate@0.8.0/umd/index.js","https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js");const decoder=new TextDecoder("utf-8");function getFrequency(e,t=!0){let s={};for(let r=0;r<e.length;r++){let a=e[r].word.at(t?0:-1);s[a]=(s[a]||0)+1}return s}self.onmessage=async e=>{if("load"===e.data.type)try{let t=await fetch(e.data.url).then((e=>e.arrayBuffer())),s=fflate.decompressSync(new Uint8Array(t)),r=decoder.decode(s),a=[];Papa.parse(r,{skipEmptyLines:!0,step:({data:e})=>{if("O"!==e[5])return;let t=e[0];a.push({word:t,species:e[1].split("|"),parts:e[2].split("|"),categories:e[3].split("|"),topics:e[4].split("|"),firstCharacter:t[0],lastCharacter:t[t.length-1],firstCharacterPhonemes:e[6],allPhonemes:e[7],lastCharacterPhonemes:e[8]})},complete:()=>{self.postMessage({type:"db",db:a,firstCharacterfrequency:getFrequency(a,!0),lastCharacterfrequency:getFrequency(a,!1)})}})}catch(e){self.postMessage({type:"error",message:e.message})}};
